{% extends "Layouts/base.html" %}
{% block container %}
<div class="container">
    <div class="goods-page">
        <div class="goods-data clearfix">
            <div class="table-wrapper-responsive">
                <table summary="Shopping cart">
                    <head>
                        <tr>
                            <th class="goos-page-image">Image</th>
                            <th class="goods-page-description">Nom</th>
                            <th class="goods-page-price">Prix</th>
                        </tr>
                    </thead>
                    <tbody id="wishlist-item-list">
                        <!-- Les produits seront ajoutés ici par JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
{% endblock container %}

{% block js %}
<script type="text/javascript">
    console.log('juste pour tester');

    if (localStorage.getItem('wishlist') == null) {
        var wishlist = {};
    } else {
        var wishlist = JSON.parse(localStorage.getItem('wishlist'));
    }

    function updateWishlist() {
        document.getElementById('wishlist-item-list').innerHTML = ''; // Vider la liste existante

        for (let item_id in wishlist) {
            let product = wishlist[item_id];
            let image = product.picture;
            let nom = product.name;
            let prix = product.price;

            // Créer la ligne pour chaque produit avec boutons pour retirer de la wishlist
            let rowString = `
                <tr id="product-${item_id}">
                    <td class="goods-page-image"> <a href="#"><img src="${image}" alt="${nom}" /></a></td>
                    <td class="goods-page-description">${nom}</td>
                    <td class="goods-page-price">${prix} €</td>
                    <td class="shoping__cart__item__close" onclick="removeFromWishlist('${item_id}')">
                        <span class="icon_close"></span>
                    </td>
                </tr>
            `;
            document.getElementById('wishlist-item-list').insertAdjacentHTML('beforeend', rowString);
        }
    }

    // Fonction pour retirer un produit de la wishlist
    function removeFromWishlist(itemId) {
        delete wishlist[itemId];
        localStorage.setItem('wishlist', JSON.stringify(wishlist));
        updateWishlist();
    }

    // Mettre à jour la liste des produits lors du chargement initial
    updateWishlist();
</script>
{% endblock %}